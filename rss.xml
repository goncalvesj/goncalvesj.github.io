<?xml version="1.0" encoding="UTF-8"?><rss xmlns:dc="http://purl.org/dc/elements/1.1/" xmlns:content="http://purl.org/rss/1.0/modules/content/" xmlns:atom="http://www.w3.org/2005/Atom" version="2.0"><channel><title><![CDATA[goncalvesj.github.io]]></title><description><![CDATA[Goncalvesj - Tech Blog]]></description><link>https://goncalvesj.github.io/</link><image><url>https://goncalvesj.github.io//logos/logo-48.png</url><title>goncalvesj.github.io</title><link>https://goncalvesj.github.io/</link></image><generator>GatsbyJS Advanced Starter</generator><lastBuildDate>Tue, 11 Aug 2020 14:52:48 GMT</lastBuildDate><atom:link href="https://goncalvesj.github.io//rss.xml" rel="self" type="application/rss+xml"/><copyright><![CDATA[Copyright © 2020. All rights reserved.]]></copyright><item><title><![CDATA[Setting up AKS Pod Azure Managed Identities]]></title><description><![CDATA[One of the things I was meaning to try out for some time was Azure Managed Identities in AKS clusters. I was always a fan of Managed…]]></description><link>https://goncalvesj.github.io//aks-pod-identity</link><guid isPermaLink="false">https://goncalvesj.github.io//aks-pod-identity</guid><category><![CDATA[AKS]]></category><category><![CDATA[Azure]]></category><pubDate>Mon, 10 Aug 2020 23:00:00 GMT</pubDate><content:encoded>&lt;p&gt;One of the things I was meaning to try out for some time was Azure Managed Identities in AKS clusters.&lt;/p&gt;
&lt;p&gt;I was always a fan of Managed Identities, I started using them in Azure App Services as soon as they were released in preview and became convinced straight away.&lt;/p&gt;
&lt;p&gt;Azure Managed Identities to me is something should be used in projects as much as possible, mostly because:&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;Increases security of your applications&lt;/li&gt;
&lt;li&gt;No more sensitive information in source control and configuration files&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;I already had an AKS cluster up an running for my own projects so the only things that was missing was setting up the pod identities to connect to Azure AD and get tokens.&lt;/p&gt;
&lt;h2 id=&quot;create-an-aks-cluster&quot; style=&quot;position:relative;&quot;&gt;&lt;a href=&quot;#create-an-aks-cluster&quot; aria-label=&quot;create an aks cluster permalink&quot; class=&quot;anchor before&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; focusable=&quot;false&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;Create an AKS cluster&lt;/h2&gt;
&lt;p&gt;The first step is to create an AKS cluster with managed identities enable.&lt;/p&gt;
&lt;p&gt;The Azure portal allows for this today and it&apos;s a straight process.&lt;/p&gt;
&lt;p&gt;An alternative is to run a terraform script that takes care of this. Script here:&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;&lt;a href=&quot;https://github.com/goncalvesj/iac-templates/blob/master/TerraformTemplates/Azure.AKS/resources.tf&quot;&gt;https://github.com/goncalvesj/iac-templates/blob/master/TerraformTemplates/Azure.AKS/resources.tf&lt;/a&gt;&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;Once the cluster is created there is 1 new resource type of Managed Identity in the resource group.&lt;/p&gt;
&lt;p&gt;&lt;span
      class=&quot;gatsby-resp-image-wrapper&quot;
      style=&quot;position: relative; display: block; margin-left: auto; margin-right: auto;  max-width: 690px;&quot;
    &gt;
      &lt;a
    class=&quot;gatsby-resp-image-link&quot;
    href=&quot;/static/a767a3d8c539b8787b4b4302a00a2781/3a737/aks-managed-identity.png&quot;
    style=&quot;display: block&quot;
    target=&quot;_blank&quot;
    rel=&quot;noopener&quot;
  &gt;
    &lt;span
    class=&quot;gatsby-resp-image-background-image&quot;
    style=&quot;padding-bottom: 13.294797687861273%; position: relative; bottom: 0; left: 0; background-image: url(&apos;data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAADCAYAAACTWi8uAAAACXBIWXMAABJ0AAASdAHeZh94AAAAbklEQVQI142Ouw6AIBAE+QRAOXygiYYcoaHh/79tlSvUGAuLySRbTFa5aUOjH1cxLSzYrocxBtZa8Zu2a63hvUfOGcyMGCOUBOcdFFiCd+Q79KQFiQgpJYk1K1ozOjecj9z16g/Ph6UU1FoRQsABo09LzkOTl5UAAAAASUVORK5CYII=&apos;); background-size: cover; display: block;&quot;
  &gt;&lt;/span&gt;
  &lt;img
        class=&quot;gatsby-resp-image-image&quot;
        alt=&quot;aks-managed-identity&quot;
        title=&quot;aks-managed-identity&quot;
        src=&quot;/static/a767a3d8c539b8787b4b4302a00a2781/1e043/aks-managed-identity.png&quot;
        srcset=&quot;/static/a767a3d8c539b8787b4b4302a00a2781/991de/aks-managed-identity.png 173w,
/static/a767a3d8c539b8787b4b4302a00a2781/e4d6b/aks-managed-identity.png 345w,
/static/a767a3d8c539b8787b4b4302a00a2781/1e043/aks-managed-identity.png 690w,
/static/a767a3d8c539b8787b4b4302a00a2781/3a737/aks-managed-identity.png 897w&quot;
        sizes=&quot;(max-width: 690px) 100vw, 690px&quot;
        style=&quot;width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;&quot;
        loading=&quot;lazy&quot;
      /&gt;
  &lt;/a&gt;
    &lt;/span&gt;&lt;/p&gt;
&lt;h2 id=&quot;adding-aad-pod-identity-to-the-cluster&quot; style=&quot;position:relative;&quot;&gt;&lt;a href=&quot;#adding-aad-pod-identity-to-the-cluster&quot; aria-label=&quot;adding aad pod identity to the cluster permalink&quot; class=&quot;anchor before&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; focusable=&quot;false&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;Adding AAD Pod Identity to the cluster&lt;/h2&gt;
&lt;p&gt;For this I looked at the steps outlined here:&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;&lt;a href=&quot;https://github.com/Azure/aad-pod-identity&quot;&gt;https://github.com/Azure/aad-pod-identity&lt;/a&gt;&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;I did the above with a small difference, I used the existing Managed Identity and didn&apos;t create a new one.&lt;/p&gt;
&lt;p&gt;So my steps were the following (I did them in Azure Cloud Shell):&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;bash&quot;&gt;&lt;pre class=&quot;language-bash&quot;&gt;&lt;code class=&quot;language-bash&quot;&gt;&lt;span class=&quot;token comment&quot;&gt;# Deploy using Helm 3&lt;/span&gt;
helm repo &lt;span class=&quot;token function&quot;&gt;add&lt;/span&gt; aad-pod-identity https://raw.githubusercontent.com/Azure/aad-pod-identity/master/charts
helm &lt;span class=&quot;token function&quot;&gt;install&lt;/span&gt; aad-pod-identity aad-pod-identity/aad-pod-identity

&lt;span class=&quot;token comment&quot;&gt;# Set up env vars&lt;/span&gt;
&lt;span class=&quot;token builtin class-name&quot;&gt;export&lt;/span&gt; &lt;span class=&quot;token assign-left variable&quot;&gt;IDENTITY_NAME&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;&quot;goncalvesj-aks-agentpool&quot;&lt;/span&gt;
&lt;span class=&quot;token builtin class-name&quot;&gt;export&lt;/span&gt; &lt;span class=&quot;token assign-left variable&quot;&gt;SUBSCRIPTION_ID&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;&quot;xxxxx&quot;&lt;/span&gt;
&lt;span class=&quot;token builtin class-name&quot;&gt;export&lt;/span&gt; &lt;span class=&quot;token assign-left variable&quot;&gt;RESOURCE_GROUP&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;&quot;xxxxx&quot;&lt;/span&gt;

&lt;span class=&quot;token builtin class-name&quot;&gt;export&lt;/span&gt; &lt;span class=&quot;token assign-left variable&quot;&gt;IDENTITY_CLIENT_ID&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;&quot;&lt;span class=&quot;token variable&quot;&gt;&lt;span class=&quot;token variable&quot;&gt;$(&lt;/span&gt;az identity show -g $RESOURCE_GROUP -n $IDENTITY_NAME --subscription $SUBSCRIPTION_ID --query clientId -otsv&lt;span class=&quot;token variable&quot;&gt;)&lt;/span&gt;&lt;/span&gt;&quot;&lt;/span&gt;
&lt;span class=&quot;token builtin class-name&quot;&gt;export&lt;/span&gt; &lt;span class=&quot;token assign-left variable&quot;&gt;IDENTITY_RESOURCE_ID&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;&quot;&lt;span class=&quot;token variable&quot;&gt;&lt;span class=&quot;token variable&quot;&gt;$(&lt;/span&gt;az identity show -g $RESOURCE_GROUP -n $IDENTITY_NAME --subscription $SUBSCRIPTION_ID --query &lt;span class=&quot;token function&quot;&gt;id&lt;/span&gt; -otsv&lt;span class=&quot;token variable&quot;&gt;)&lt;/span&gt;&lt;/span&gt;&quot;&lt;/span&gt;

&lt;span class=&quot;token comment&quot;&gt;# Since the role assignent was created when the cluster was created&lt;/span&gt;
&lt;span class=&quot;token comment&quot;&gt;# we only have to get the role assignment id&lt;/span&gt;
&lt;span class=&quot;token comment&quot;&gt;# Look for the one where the principal name property is the same as the client id&lt;/span&gt;
az role assignment list -g &lt;span class=&quot;token variable&quot;&gt;$RESOURCE_GROUP&lt;/span&gt;

&lt;span class=&quot;token comment&quot;&gt;# Get the id and save as env var, should be similar to this&lt;/span&gt;
&lt;span class=&quot;token builtin class-name&quot;&gt;export&lt;/span&gt; &lt;span class=&quot;token assign-left variable&quot;&gt;IDENTITY_ASSIGNMENT_ID&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;&quot;/subscriptions/xxxxx/resourcegroups/xxxxx/providers/Microsoft.Authorization/roleAssignments/xxxxx&quot;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;h2 id=&quot;deploy-azureidentity--azureidentitybinding-as-defined-in-the-github-repo&quot; style=&quot;position:relative;&quot;&gt;&lt;a href=&quot;#deploy-azureidentity--azureidentitybinding-as-defined-in-the-github-repo&quot; aria-label=&quot;deploy azureidentity  azureidentitybinding as defined in the github repo permalink&quot; class=&quot;anchor before&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; focusable=&quot;false&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;Deploy AzureIdentity &amp;#x26; AzureIdentityBinding as defined in the github repo&lt;/h2&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;bash&quot;&gt;&lt;pre class=&quot;language-bash&quot;&gt;&lt;code class=&quot;language-bash&quot;&gt;&lt;span class=&quot;token function&quot;&gt;cat&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;&amp;lt;&amp;lt;&lt;/span&gt;EOF &lt;span class=&quot;token operator&quot;&gt;|&lt;/span&gt; kubectl apply -f -
apiVersion: &lt;span class=&quot;token string&quot;&gt;&quot;aadpodidentity.k8s.io/v1&quot;&lt;/span&gt;
kind: AzureIdentity
metadata:
  name: &lt;span class=&quot;token variable&quot;&gt;$IDENTITY_NAME&lt;/span&gt;
spec:
  type: &lt;span class=&quot;token number&quot;&gt;0&lt;/span&gt;
  resourceID: &lt;span class=&quot;token variable&quot;&gt;$IDENTITY_RESOURCE_ID&lt;/span&gt;
  clientID: &lt;span class=&quot;token variable&quot;&gt;$IDENTITY_CLIENT_ID&lt;/span&gt;
EOF

&lt;span class=&quot;token function&quot;&gt;cat&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;&amp;lt;&amp;lt;&lt;/span&gt;EOF &lt;span class=&quot;token operator&quot;&gt;|&lt;/span&gt; kubectl apply -f -
apiVersion: &lt;span class=&quot;token string&quot;&gt;&quot;aadpodidentity.k8s.io/v1&quot;&lt;/span&gt;
kind: AzureIdentityBinding
metadata:
  name: &lt;span class=&quot;token variable&quot;&gt;$IDENTITY_NAME&lt;/span&gt;-binding
spec:
  azureIdentity: &lt;span class=&quot;token variable&quot;&gt;$IDENTITY_NAME&lt;/span&gt;
  selector: &lt;span class=&quot;token variable&quot;&gt;$IDENTITY_NAME&lt;/span&gt;
EOF&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;h2 id=&quot;testing&quot; style=&quot;position:relative;&quot;&gt;&lt;a href=&quot;#testing&quot; aria-label=&quot;testing permalink&quot; class=&quot;anchor before&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; focusable=&quot;false&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;Testing&lt;/h2&gt;
&lt;p&gt;For testing I created a .NET Core Worker Service with the following code.&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;csharp&quot;&gt;&lt;pre class=&quot;language-csharp&quot;&gt;&lt;code class=&quot;language-csharp&quot;&gt;&lt;span class=&quot;token keyword&quot;&gt;while&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;!&lt;/span&gt;stoppingToken&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;IsCancellationRequested&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;
    _logger&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;LogInformation&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;&quot;Worker running at: {time}&quot;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; DateTimeOffset&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;Now&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;

    &lt;span class=&quot;token keyword&quot;&gt;try&lt;/span&gt;
    &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;
        &lt;span class=&quot;token class-name&quot;&gt;&lt;span class=&quot;token keyword&quot;&gt;var&lt;/span&gt;&lt;/span&gt; secretClient &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;new&lt;/span&gt; &lt;span class=&quot;token constructor-invocation class-name&quot;&gt;SecretClient&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;
                            &lt;span class=&quot;token keyword&quot;&gt;new&lt;/span&gt; &lt;span class=&quot;token constructor-invocation class-name&quot;&gt;Uri&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;&quot;https://xxxxx.vault.azure.net/&quot;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;
                            &lt;span class=&quot;token keyword&quot;&gt;new&lt;/span&gt; &lt;span class=&quot;token constructor-invocation class-name&quot;&gt;DefaultAzureCredential&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;
        &lt;span class=&quot;token class-name&quot;&gt;&lt;span class=&quot;token keyword&quot;&gt;var&lt;/span&gt;&lt;/span&gt; secret &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;await&lt;/span&gt; secretClient&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;GetSecretAsync&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;&quot;Secret1&quot;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;token named-parameter punctuation&quot;&gt;cancellationToken&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; stoppingToken&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;

        _logger&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;LogInformation&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token interpolation-string&quot;&gt;&lt;span class=&quot;token string&quot;&gt;$&quot;KV Secret: &lt;/span&gt;&lt;span class=&quot;token interpolation&quot;&gt;&lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;&lt;span class=&quot;token expression language-csharp&quot;&gt;secret&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;Value&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;Value&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;&quot;&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;
    &lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;
    &lt;span class=&quot;token keyword&quot;&gt;catch&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token class-name&quot;&gt;Exception&lt;/span&gt; e&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
    &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;
        Console&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;WriteLine&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;e&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;
        _logger&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;LogError&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;e&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&quot;Error:&quot;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;
        &lt;span class=&quot;token keyword&quot;&gt;throw&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;
    &lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;

    &lt;span class=&quot;token keyword&quot;&gt;await&lt;/span&gt; Task&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;Delay&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token number&quot;&gt;10000&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; stoppingToken&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;
&lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;h2 id=&quot;deploy&quot; style=&quot;position:relative;&quot;&gt;&lt;a href=&quot;#deploy&quot; aria-label=&quot;deploy permalink&quot; class=&quot;anchor before&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; focusable=&quot;false&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;Deploy&lt;/h2&gt;
&lt;p&gt;Deployed it to Docker Hub and then to the AKS cluster as a single pod.&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;bash&quot;&gt;&lt;pre class=&quot;language-bash&quot;&gt;&lt;code class=&quot;language-bash&quot;&gt;&lt;span class=&quot;token function&quot;&gt;cat&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;&amp;lt;&amp;lt;&lt;/span&gt; EOF &lt;span class=&quot;token operator&quot;&gt;|&lt;/span&gt; kubectl apply -f -
apiVersion: v1
kind: Pod
metadata:
  name: workerservice2
  labels:
    aadpodidbinding: &lt;span class=&quot;token variable&quot;&gt;$IDENTITY_NAME&lt;/span&gt;
spec:
  containers:
  - name: workerservice2
    image: goncalvesj/workerservice2:20200811134040
  nodeSelector:
    kubernetes.io/os: linux
EOF&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;If all went well you should be able to see the secret being printed to the container logs with:&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;bash&quot;&gt;&lt;pre class=&quot;language-bash&quot;&gt;&lt;code class=&quot;language-bash&quot;&gt;kubectl logs workservice2 --follow&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;h3 id=&quot;credits-to-everyone-who-built-and-works-on-the-httpsgithubcomazureaad-pod-identity-and-made-a-guide-so-easy-to-follow&quot; style=&quot;position:relative;&quot;&gt;&lt;a href=&quot;#credits-to-everyone-who-built-and-works-on-the-httpsgithubcomazureaad-pod-identity-and-made-a-guide-so-easy-to-follow&quot; aria-label=&quot;credits to everyone who built and works on the httpsgithubcomazureaad pod identity and made a guide so easy to follow permalink&quot; class=&quot;anchor before&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; focusable=&quot;false&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;Credits to everyone who built and works on the &lt;strong&gt;&lt;a href=&quot;https://github.com/Azure/aad-pod-identity&quot;&gt;https://github.com/Azure/aad-pod-identity&lt;/a&gt;&lt;/strong&gt; and made a guide so easy to follow&lt;/h3&gt;
&lt;p&gt;&lt;strong&gt;Hope this helped! Reach out to me on twitter if you have any questions!&lt;/strong&gt;&lt;/p&gt;</content:encoded><author>jp.reisgoncalves@gmail.com</author></item><item><title><![CDATA[Deleting an Azure B2C Tenant]]></title><description><![CDATA[In the past months I had to delete a couple of Azure B2C tenants. And while the experience in the Azure Portal is straight forward enough I…]]></description><link>https://goncalvesj.github.io//delete-ad-b-2-c-tenant</link><guid isPermaLink="false">https://goncalvesj.github.io//delete-ad-b-2-c-tenant</guid><category><![CDATA[ADB2C]]></category><category><![CDATA[Azure]]></category><pubDate>Tue, 04 Aug 2020 23:00:00 GMT</pubDate><content:encoded>&lt;p&gt;In the past months I had to delete a couple of Azure B2C tenants. And while the experience in the Azure Portal is straight forward enough I was always getting stuck in clearing the Azure AD Enterprise Applications.&lt;/p&gt;
&lt;p&gt;In particular the Enterprise App Registration for Azure DevOps. Even as a Global Admin the delete button is always disabled. Since the Portal does not allow this operation the solution is to use PowerShell for this task.&lt;/p&gt;
&lt;p&gt;&lt;span
      class=&quot;gatsby-resp-image-wrapper&quot;
      style=&quot;position: relative; display: block; margin-left: auto; margin-right: auto;  max-width: 690px;&quot;
    &gt;
      &lt;a
    class=&quot;gatsby-resp-image-link&quot;
    href=&quot;/static/29b905d591169e5386c1bdab8f0e85c1/47ff6/devops-delete-button.png&quot;
    style=&quot;display: block&quot;
    target=&quot;_blank&quot;
    rel=&quot;noopener&quot;
  &gt;
    &lt;span
    class=&quot;gatsby-resp-image-background-image&quot;
    style=&quot;padding-bottom: 31.79190751445087%; position: relative; bottom: 0; left: 0; background-image: url(&apos;data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAGCAYAAADDl76dAAAACXBIWXMAABJ0AAASdAHeZh94AAABAUlEQVQY01WR22qEQBBEfRbxroxXdAyKiaAoKuy6gYCPCUn+/2MqWxM02YfDzNBd3dU92tv7Ny7XK15vN2zbhn3fsa4r+r7HPM9YlgVSSpimCcdxYNv2A5ZlKXhnXJPVE5I0RZ5lKIoCSZLA8zyV4Ps+wjBUb9d1Fbz/vX0EQQAhxKnRwkwiSxMl1nUdhmGcbpiU57kSRFGkYEPCRiLOUVUV2rZFHMe/DoWs8fLcom4aFazrWo3IIKGQ0MnB4SaKhCr+36XGyhQcrjgKk+mU5zEy93Q0OaDj7L4qwoJE+/j8Uh8xTROGYTgZx1ElcuSyLB92y2Js0Nyn4sfxA6nvug4/K0+e1oBG67MAAAAASUVORK5CYII=&apos;); background-size: cover; display: block;&quot;
  &gt;&lt;/span&gt;
  &lt;img
        class=&quot;gatsby-resp-image-image&quot;
        alt=&quot;devops-delete-button&quot;
        title=&quot;devops-delete-button&quot;
        src=&quot;/static/29b905d591169e5386c1bdab8f0e85c1/1e043/devops-delete-button.png&quot;
        srcset=&quot;/static/29b905d591169e5386c1bdab8f0e85c1/991de/devops-delete-button.png 173w,
/static/29b905d591169e5386c1bdab8f0e85c1/e4d6b/devops-delete-button.png 345w,
/static/29b905d591169e5386c1bdab8f0e85c1/1e043/devops-delete-button.png 690w,
/static/29b905d591169e5386c1bdab8f0e85c1/47ff6/devops-delete-button.png 852w&quot;
        sizes=&quot;(max-width: 690px) 100vw, 690px&quot;
        style=&quot;width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;&quot;
        loading=&quot;lazy&quot;
      /&gt;
  &lt;/a&gt;
    &lt;/span&gt;&lt;/p&gt;
&lt;h2 id=&quot;getting-started&quot; style=&quot;position:relative;&quot;&gt;&lt;a href=&quot;#getting-started&quot; aria-label=&quot;getting started permalink&quot; class=&quot;anchor before&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; focusable=&quot;false&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;Getting Started&lt;/h2&gt;
&lt;p&gt;The below steps go through the process of deleting an Enterprise Application using PowerShell.&lt;/p&gt;
&lt;p&gt;Windows PowerShell 5.1 with the AzureAD module was used.&lt;/p&gt;
&lt;h2 id=&quot;1---connect-to-azure-ad&quot; style=&quot;position:relative;&quot;&gt;&lt;a href=&quot;#1---connect-to-azure-ad&quot; aria-label=&quot;1   connect to azure ad permalink&quot; class=&quot;anchor before&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; focusable=&quot;false&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;1 - Connect to Azure AD&lt;/h2&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;powershell&quot;&gt;&lt;pre class=&quot;language-powershell&quot;&gt;&lt;code class=&quot;language-powershell&quot;&gt;&lt;span class=&quot;token variable&quot;&gt;$TenantId&lt;/span&gt; = &lt;span class=&quot;token string&quot;&gt;&quot;xxxxx-xxxxx-xxxxx-xxxxx-xxxxx&quot;&lt;/span&gt;
Connect&lt;span class=&quot;token operator&quot;&gt;-&lt;/span&gt;AzureAD &lt;span class=&quot;token operator&quot;&gt;-&lt;/span&gt;TenantId &lt;span class=&quot;token variable&quot;&gt;$TenantId&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;h2 id=&quot;2---create-new-user&quot; style=&quot;position:relative;&quot;&gt;&lt;a href=&quot;#2---create-new-user&quot; aria-label=&quot;2   create new user permalink&quot; class=&quot;anchor before&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; focusable=&quot;false&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;2 - Create New User&lt;/h2&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;powershell&quot;&gt;&lt;pre class=&quot;language-powershell&quot;&gt;&lt;code class=&quot;language-powershell&quot;&gt;&lt;span class=&quot;token variable&quot;&gt;$NewUserEmail&lt;/span&gt; = &lt;span class=&quot;token string&quot;&gt;&quot;NewUser@xxxxx.onmicrosoft.com&quot;&lt;/span&gt;
&lt;span class=&quot;token variable&quot;&gt;$NewUserName&lt;/span&gt; = &lt;span class=&quot;token string&quot;&gt;&quot;NewUser&quot;&lt;/span&gt;

&lt;span class=&quot;token variable&quot;&gt;$PasswordProfile&lt;/span&gt; = &lt;span class=&quot;token function&quot;&gt;New-Object&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;-&lt;/span&gt;TypeName Microsoft&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;Open&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;AzureAD&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;Model&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;PasswordProfile
&lt;span class=&quot;token variable&quot;&gt;$PasswordProfile&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;Password = &lt;span class=&quot;token string&quot;&gt;&quot;XXXXX&quot;&lt;/span&gt;
New&lt;span class=&quot;token operator&quot;&gt;-&lt;/span&gt;AzureADUser &lt;span class=&quot;token operator&quot;&gt;-&lt;/span&gt;DisplayName &lt;span class=&quot;token variable&quot;&gt;$NewUserName&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;-&lt;/span&gt;PasswordProfile &lt;span class=&quot;token variable&quot;&gt;$PasswordProfile&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;-&lt;/span&gt;UserPrincipalName &lt;span class=&quot;token variable&quot;&gt;$NewUserEmail&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;-&lt;/span&gt;AccountEnabled &lt;span class=&quot;token boolean&quot;&gt;$true&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;-&lt;/span&gt;MailNickName &lt;span class=&quot;token variable&quot;&gt;$NewUserName&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;h2 id=&quot;3---set-new-user-as-global-admin&quot; style=&quot;position:relative;&quot;&gt;&lt;a href=&quot;#3---set-new-user-as-global-admin&quot; aria-label=&quot;3   set new user as global admin permalink&quot; class=&quot;anchor before&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; focusable=&quot;false&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;3 - Set New User as Global Admin&lt;/h2&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;powershell&quot;&gt;&lt;pre class=&quot;language-powershell&quot;&gt;&lt;code class=&quot;language-powershell&quot;&gt;&lt;span class=&quot;token variable&quot;&gt;$roleMember&lt;/span&gt; = Get&lt;span class=&quot;token operator&quot;&gt;-&lt;/span&gt;AzureADUser &lt;span class=&quot;token operator&quot;&gt;-&lt;/span&gt;ObjectId &lt;span class=&quot;token variable&quot;&gt;$NewUserEmail&lt;/span&gt;
&lt;span class=&quot;token variable&quot;&gt;$role&lt;/span&gt; = Get&lt;span class=&quot;token operator&quot;&gt;-&lt;/span&gt;AzureADDirectoryRole &lt;span class=&quot;token punctuation&quot;&gt;|&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;Where-Object&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;&lt;span class=&quot;token variable&quot;&gt;$_&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;displayName &lt;span class=&quot;token operator&quot;&gt;-eq&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&apos;Company Administrator&apos;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;
Add&lt;span class=&quot;token operator&quot;&gt;-&lt;/span&gt;AzureADDirectoryRoleMember &lt;span class=&quot;token operator&quot;&gt;-&lt;/span&gt;ObjectId &lt;span class=&quot;token variable&quot;&gt;$role&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;ObjectId &lt;span class=&quot;token operator&quot;&gt;-&lt;/span&gt;RefObjectId &lt;span class=&quot;token variable&quot;&gt;$roleMember&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;ObjectId&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;h2 id=&quot;4---log-in-with-new-user&quot; style=&quot;position:relative;&quot;&gt;&lt;a href=&quot;#4---log-in-with-new-user&quot; aria-label=&quot;4   log in with new user permalink&quot; class=&quot;anchor before&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; focusable=&quot;false&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;4 - Log in with new User&lt;/h2&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;powershell&quot;&gt;&lt;pre class=&quot;language-powershell&quot;&gt;&lt;code class=&quot;language-powershell&quot;&gt;Connect&lt;span class=&quot;token operator&quot;&gt;-&lt;/span&gt;AzureAD &lt;span class=&quot;token operator&quot;&gt;-&lt;/span&gt;TenantId &lt;span class=&quot;token variable&quot;&gt;$TenantId&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;-&lt;/span&gt;AccountId &lt;span class=&quot;token variable&quot;&gt;$NewUserEmail&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;h2 id=&quot;5---get-enterprise-app-object-id&quot; style=&quot;position:relative;&quot;&gt;&lt;a href=&quot;#5---get-enterprise-app-object-id&quot; aria-label=&quot;5   get enterprise app object id permalink&quot; class=&quot;anchor before&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; focusable=&quot;false&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;5 - Get Enterprise App Object Id&lt;/h2&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;powershell&quot;&gt;&lt;pre class=&quot;language-powershell&quot;&gt;&lt;code class=&quot;language-powershell&quot;&gt;&lt;span class=&quot;token variable&quot;&gt;$AzDevOps&lt;/span&gt; = Get&lt;span class=&quot;token operator&quot;&gt;-&lt;/span&gt;AzureADServicePrincipal &lt;span class=&quot;token punctuation&quot;&gt;|&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;Where-Object&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;&lt;span class=&quot;token variable&quot;&gt;$_&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;displayName &lt;span class=&quot;token operator&quot;&gt;-eq&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&apos;Azure DevOps&apos;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;h2 id=&quot;6---remove-enterprise-app&quot; style=&quot;position:relative;&quot;&gt;&lt;a href=&quot;#6---remove-enterprise-app&quot; aria-label=&quot;6   remove enterprise app permalink&quot; class=&quot;anchor before&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; focusable=&quot;false&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;6 - Remove Enterprise App&lt;/h2&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;powershell&quot;&gt;&lt;pre class=&quot;language-powershell&quot;&gt;&lt;code class=&quot;language-powershell&quot;&gt;Remove&lt;span class=&quot;token operator&quot;&gt;-&lt;/span&gt;AzureADServicePrincipal &lt;span class=&quot;token operator&quot;&gt;-&lt;/span&gt;ObjectId &lt;span class=&quot;token variable&quot;&gt;$AzDevOps&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;ObjectId&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;h3 id=&quot;61----if-just-removing-the-azure-devops-enterprise-app-is-not-enough-run-this&quot; style=&quot;position:relative;&quot;&gt;&lt;a href=&quot;#61----if-just-removing-the-azure-devops-enterprise-app-is-not-enough-run-this&quot; aria-label=&quot;61    if just removing the azure devops enterprise app is not enough run this permalink&quot; class=&quot;anchor before&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; focusable=&quot;false&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;6.1 -  If just removing the Azure DevOps enterprise app is not enough, run this&lt;/h3&gt;
&lt;h3 id=&quot;611---some-errors-will-appear-specified-app-principal-id-is-microsoft-internal-its-safe-to-ignore-them&quot; style=&quot;position:relative;&quot;&gt;&lt;a href=&quot;#611---some-errors-will-appear-specified-app-principal-id-is-microsoft-internal-its-safe-to-ignore-them&quot; aria-label=&quot;611   some errors will appear specified app principal id is microsoft internal its safe to ignore them permalink&quot; class=&quot;anchor before&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; focusable=&quot;false&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;6.1.1 - Some errors will appear: &quot;Specified App Principal ID is Microsoft Internal.&quot; it&apos;s safe to ignore them&lt;/h3&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;powershell&quot;&gt;&lt;pre class=&quot;language-powershell&quot;&gt;&lt;code class=&quot;language-powershell&quot;&gt;Get&lt;span class=&quot;token operator&quot;&gt;-&lt;/span&gt;AzureADServicePrincipal &lt;span class=&quot;token punctuation&quot;&gt;|&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;Select-Object&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;-&lt;/span&gt;ExpandProperty ObjectId &lt;span class=&quot;token punctuation&quot;&gt;|&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;ForEach-Object&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;
     Remove&lt;span class=&quot;token operator&quot;&gt;-&lt;/span&gt;AzureADServicePrincipal &lt;span class=&quot;token operator&quot;&gt;-&lt;/span&gt;ObjectId &lt;span class=&quot;token variable&quot;&gt;$_&lt;/span&gt;
&lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;h2 id=&quot;7---now-go-the-azure-portal---azure-ad---delete-newuser---delete-tenant&quot; style=&quot;position:relative;&quot;&gt;&lt;a href=&quot;#7---now-go-the-azure-portal---azure-ad---delete-newuser---delete-tenant&quot; aria-label=&quot;7   now go the azure portal   azure ad   delete newuser   delete tenant permalink&quot; class=&quot;anchor before&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; focusable=&quot;false&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;7 - Now go the Azure Portal -&gt; Azure AD -&gt; Delete NewUser -&gt; Delete tenant&lt;/h2&gt;
&lt;p&gt;Now you should see everything ticked green and ready to delete.&lt;/p&gt;
&lt;p&gt;&lt;span
      class=&quot;gatsby-resp-image-wrapper&quot;
      style=&quot;position: relative; display: block; margin-left: auto; margin-right: auto;  max-width: 690px;&quot;
    &gt;
      &lt;a
    class=&quot;gatsby-resp-image-link&quot;
    href=&quot;/static/80d693a52b4c1e32f0357767fd5b93c8/0d98f/b2c-readytodelete.png&quot;
    style=&quot;display: block&quot;
    target=&quot;_blank&quot;
    rel=&quot;noopener&quot;
  &gt;
    &lt;span
    class=&quot;gatsby-resp-image-background-image&quot;
    style=&quot;padding-bottom: 94.79768786127167%; position: relative; bottom: 0; left: 0; background-image: url(&apos;data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAATCAYAAACQjC21AAAACXBIWXMAABJ0AAASdAHeZh94AAAByElEQVQ4y61TTY/TMBQ0cICVSmzHaT7c2OkmTZvdpqqEtCBOnPgn3Pn/p+E9p6mybLJUaA8jW37Pk5l5jqjbI3b7R9T7E6rdEa5qsNs1KMsSSilorQPUjRAtXT71RxwOe3hn4UqLpr5HnqVQMoJWkohlWG+B0OsS6809EruFdTWUyRHpFJJWnRQvwHUZL0N8zM5Y+e+Q/gmr8gmR/xbAe8Zn93U4u6x3xRe8i3t8MCe8n4DPGMI5B2stpJSI4/ia2d/gGmda2Jz6i7Af+5MkQdPUYC5RVRW6rgtDGBviKdGVkEKXGrkzSAtDhMPZ+DEmNcZAFKSubVtst9twwMUlaB1jndPldNjP9QgmOp/PzxTOWx4UZuVAygr1ROF4V9jNBjX539Ca5/k/FabWYJ2Rk6lCcja6C0PhDPu+h6c8x7BnCUlVaklhNuyvmU8Veu/RPXQ0IR+CnTbMEWalCZZHwhcZcnZseTwwQf4rlgszKJxYNlPLnN2efjtHSlktP6M0TZ+9swAeClsuLlNeGgpfjKIoEEyxNG0mDRNeqIvli2oWWtOq1WJ9kfB/IThcfflP3wJCru4gV5/eTmH74xcOP38Pk3rlDd6KP2rt1MUPkN4gAAAAAElFTkSuQmCC&apos;); background-size: cover; display: block;&quot;
  &gt;&lt;/span&gt;
  &lt;img
        class=&quot;gatsby-resp-image-image&quot;
        alt=&quot;b2c-delete&quot;
        title=&quot;b2c-delete&quot;
        src=&quot;/static/80d693a52b4c1e32f0357767fd5b93c8/1e043/b2c-readytodelete.png&quot;
        srcset=&quot;/static/80d693a52b4c1e32f0357767fd5b93c8/991de/b2c-readytodelete.png 173w,
/static/80d693a52b4c1e32f0357767fd5b93c8/e4d6b/b2c-readytodelete.png 345w,
/static/80d693a52b4c1e32f0357767fd5b93c8/1e043/b2c-readytodelete.png 690w,
/static/80d693a52b4c1e32f0357767fd5b93c8/e3189/b2c-readytodelete.png 1035w,
/static/80d693a52b4c1e32f0357767fd5b93c8/0d98f/b2c-readytodelete.png 1276w&quot;
        sizes=&quot;(max-width: 690px) 100vw, 690px&quot;
        style=&quot;width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;&quot;
        loading=&quot;lazy&quot;
      /&gt;
  &lt;/a&gt;
    &lt;/span&gt;&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;Hope this helped! Reach out to me on twitter if you have any questions!&lt;/strong&gt;&lt;/p&gt;</content:encoded><author>jp.reisgoncalves@gmail.com</author></item><item><title><![CDATA[Getting Started with Terraform]]></title><description><![CDATA[For most of projects that I worked on, when we had the chance of creating infrastructure as code the decision was always to go to ARM…]]></description><link>https://goncalvesj.github.io//getting-started-terraform</link><guid isPermaLink="false">https://goncalvesj.github.io//getting-started-terraform</guid><category><![CDATA[Terraform]]></category><category><![CDATA[Azure]]></category><pubDate>Sun, 31 May 2020 23:00:00 GMT</pubDate><content:encoded>&lt;p&gt;For most of projects that I worked on, when we had the chance of creating infrastructure as code the decision was always to go to ARM templates. Mostly because the skillset of the team was favourable to that technology.&lt;/p&gt;
&lt;p&gt;Out of my own curiosity I decided to try terraform, not just to learn a different tool for &lt;code class=&quot;language-text&quot;&gt;IaC&lt;/code&gt; but also because the &lt;code class=&quot;language-text&quot;&gt;terraform plan&lt;/code&gt; and &lt;code class=&quot;language-text&quot;&gt;terraform apply&lt;/code&gt; functionalities are really useful when you&apos;re creating infrastructure.&lt;/p&gt;
&lt;p&gt;Also because of the support that Microsoft is giving this tool, being now documented in their own docs, and the interesting fact that Azure uses the &lt;code class=&quot;language-text&quot;&gt;Hashcorp Packer&lt;/code&gt; tool to build the Azure VMs base images. Makes me think that this relationship is going to last quite a bit and it&apos;s definitely worth investing some time on it.&lt;/p&gt;
&lt;h2 id=&quot;getting-started&quot; style=&quot;position:relative;&quot;&gt;&lt;a href=&quot;#getting-started&quot; aria-label=&quot;getting started permalink&quot; class=&quot;anchor before&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; focusable=&quot;false&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;Getting Started&lt;/h2&gt;
&lt;p&gt;Let&apos;s start by listing the prerequisites for working with Terraform on Azure:&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;a href=&quot;https://learn.hashicorp.com/terraform/getting-started/install.html&quot;&gt;Terraform CLI&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;https://docs.microsoft.com/en-us/cli/azure/install-azure-cli-windows?view=azure-cli-latest&quot;&gt;Azure CLI&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;After installing you need to connect to your azure subscription.&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;bash&quot;&gt;&lt;pre class=&quot;language-bash&quot;&gt;&lt;code class=&quot;language-bash&quot;&gt;&lt;span class=&quot;token comment&quot;&gt;# Login to Azure&lt;/span&gt;
az login
&lt;span class=&quot;token comment&quot;&gt;# Set subcription if you have more than one&lt;/span&gt;
az account &lt;span class=&quot;token builtin class-name&quot;&gt;set&lt;/span&gt; -s SUBSCRIPTIONID&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;h2 id=&quot;creating-resources&quot; style=&quot;position:relative;&quot;&gt;&lt;a href=&quot;#creating-resources&quot; aria-label=&quot;creating resources permalink&quot; class=&quot;anchor before&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; focusable=&quot;false&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;Creating Resources&lt;/h2&gt;
&lt;p&gt;Now that we are connected to the cloud we can start setting up our infrastructure.&lt;/p&gt;
&lt;p&gt;The steps below will create an Azure Resource Group, an Azure App Service Plan and an App Service that uses a Docker image.&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;Create a file &lt;code class=&quot;language-text&quot;&gt;resources.tf&lt;/code&gt;&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;Set a provider&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;yaml&quot;&gt;&lt;pre class=&quot;language-yaml&quot;&gt;&lt;code class=&quot;language-yaml&quot;&gt;&lt;span class=&quot;token comment&quot;&gt;# Sets Azure as our provider&lt;/span&gt;
provider &quot;azurerm&quot; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;
    version = &quot;=2.0.0&quot;
    features &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;
&lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;Create a resource group&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;yaml&quot;&gt;&lt;pre class=&quot;language-yaml&quot;&gt;&lt;code class=&quot;language-yaml&quot;&gt;resource &quot;azurerm_resource_group&quot; &quot;example&quot; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;
    name     = &quot;RG&lt;span class=&quot;token punctuation&quot;&gt;-&lt;/span&gt;Containers&quot;
    location = &quot;North Europe&quot;
&lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;Create an App Service Plan on Linux&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;yaml&quot;&gt;&lt;pre class=&quot;language-yaml&quot;&gt;&lt;code class=&quot;language-yaml&quot;&gt;resource &quot;azurerm_app_service_plan&quot; &quot;example&quot; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;
    name                = &quot;RG&lt;span class=&quot;token punctuation&quot;&gt;-&lt;/span&gt;AppPlan&lt;span class=&quot;token punctuation&quot;&gt;-&lt;/span&gt;Linux&quot;
    location            = azurerm_resource_group.example.location
    resource_group_name = azurerm_resource_group.example.name
    kind                = &quot;Linux&quot;
    reserved            = true

    sku &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;
        tier = &quot;Basic&quot;
        size = &quot;B1&quot;
    &lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;
&lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;Create an App Service that uses a Docker image&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;yaml&quot;&gt;&lt;pre class=&quot;language-yaml&quot;&gt;&lt;code class=&quot;language-yaml&quot;&gt;resource &quot;azurerm_app_service&quot; &quot;dockerapp&quot; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;
    name                = &quot;goncalvesj&lt;span class=&quot;token punctuation&quot;&gt;-&lt;/span&gt;ncngb2c&quot;
    location            = azurerm_resource_group.example.location
    resource_group_name = azurerm_resource_group.example.name
    app_service_plan_id = azurerm_app_service_plan.example.id
    https_only          = true

    app_settings = &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;
        WEBSITES_ENABLE_APP_SERVICE_STORAGE = false
    &lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;

    site_config &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;
        linux_fx_version = &quot;DOCKER&lt;span class=&quot;token punctuation&quot;&gt;|&lt;/span&gt;goncalvesj/netcore&lt;span class=&quot;token punctuation&quot;&gt;-&lt;/span&gt;angular&lt;span class=&quot;token punctuation&quot;&gt;-&lt;/span&gt;b2c&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;dev&quot;
        always_on        = &quot;true&quot;
    &lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;

    identity &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;
        type = &quot;SystemAssigned&quot;
    &lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;
&lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;Optional - Create a remote backend&lt;/p&gt;
&lt;p&gt;Terraform has the functionality of having a remote backend to store the state of our infrasctruture. If you&apos;re working on a big team and there might be cases of multiple people working at the same time on the infrastrucure side you should use a remote backend to avoid conflicts and concurrent updates.&lt;/p&gt;
&lt;p&gt;The below uses Azure Storage accounts as a remote backend and the storage needs to be created beforehand.&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;yaml&quot;&gt;&lt;pre class=&quot;language-yaml&quot;&gt;&lt;code class=&quot;language-yaml&quot;&gt;terraform &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;
    backend &quot;azurerm&quot; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;
        resource_group_name  = &quot;RG&lt;span class=&quot;token punctuation&quot;&gt;-&lt;/span&gt;Storage&quot;
        storage_account_name = &quot;goncalvesjtfbackends&quot;
        container_name       = &quot;tfstate&quot;
        key                  = &quot;azureappservicedocker.terraform.tfstate&quot;
    &lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;
&lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;/li&gt;
&lt;li&gt;Run &lt;code class=&quot;language-text&quot;&gt;terraform plan&lt;/code&gt; to create an output of what is going to be added, changed or deleted.&lt;/li&gt;
&lt;li&gt;Then if you&apos;re happy with the changes, run &lt;code class=&quot;language-text&quot;&gt;terraform apply&lt;/code&gt; and watch all the resources getting created on Azure.&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;&lt;strong&gt;Hope this helped!Reach out to me on twitter if you have any questions!&lt;/strong&gt;&lt;/p&gt;</content:encoded><author>jp.reisgoncalves@gmail.com</author></item><item><title><![CDATA[Updating and Patching AKS]]></title><description><![CDATA[Recently I came across two situations where I had to make changes to some components in an AKS cluster with minimum impact. I didn't want to…]]></description><link>https://goncalvesj.github.io//update-patch-aks</link><guid isPermaLink="false">https://goncalvesj.github.io//update-patch-aks</guid><category><![CDATA[AKS]]></category><pubDate>Tue, 14 Apr 2020 23:00:00 GMT</pubDate><content:encoded>&lt;p&gt;Recently I came across two situations where I had to make changes to some components in an AKS cluster with minimum impact. I didn&apos;t want to be applying the full &lt;code class=&quot;language-text&quot;&gt;yaml&lt;/code&gt; files again since I was not too familiar with this particular set up.&lt;/p&gt;
&lt;h2 id=&quot;updating-an-image&quot; style=&quot;position:relative;&quot;&gt;&lt;a href=&quot;#updating-an-image&quot; aria-label=&quot;updating an image permalink&quot; class=&quot;anchor before&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; focusable=&quot;false&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;Updating an image&lt;/h2&gt;
&lt;p&gt;The first change I had to make was a replace of a docker image that one of the services was using. For that I updated the AKS deployment.&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;bash&quot;&gt;&lt;pre class=&quot;language-bash&quot;&gt;&lt;code class=&quot;language-bash&quot;&gt;&lt;span class=&quot;token comment&quot;&gt;# Updates the Image&lt;/span&gt;
kubectl &lt;span class=&quot;token builtin class-name&quot;&gt;set&lt;/span&gt; image deployment/iothub-manager iothub-manager-pod&lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt;goncalvesj/iothub-manager-dotnet:01 --record
&lt;span class=&quot;token comment&quot;&gt;# Checks status&lt;/span&gt;
kubectl rollout status deployment/iothub-manager
&lt;span class=&quot;token comment&quot;&gt;# If something goes wrong use this to rollback the update&lt;/span&gt;
kubectl rollout undo deployment/iothub-manager&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;h2 id=&quot;updating-an-ingress&quot; style=&quot;position:relative;&quot;&gt;&lt;a href=&quot;#updating-an-ingress&quot; aria-label=&quot;updating an ingress permalink&quot; class=&quot;anchor before&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; focusable=&quot;false&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;Updating an Ingress&lt;/h2&gt;
&lt;p&gt;The second change was to expose another service in an ingress controller, for that I used a combination of &lt;code class=&quot;language-text&quot;&gt;JSON&lt;/code&gt; and the &lt;code class=&quot;language-text&quot;&gt;kubectl&lt;/code&gt; patch command.&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;json&quot;&gt;&lt;pre class=&quot;language-json&quot;&gt;&lt;code class=&quot;language-json&quot;&gt;# JSON to add one extra path and service.
# This will append the extra path at the end of the ingress controller paths section.
&lt;span class=&quot;token punctuation&quot;&gt;[&lt;/span&gt;
  &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;
    &lt;span class=&quot;token property&quot;&gt;&quot;op&quot;&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&quot;add&quot;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;
    &lt;span class=&quot;token property&quot;&gt;&quot;path&quot;&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&quot;/spec/rules/0/http/paths/-&quot;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;
    &lt;span class=&quot;token property&quot;&gt;&quot;value&quot;&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;
      &lt;span class=&quot;token property&quot;&gt;&quot;path&quot;&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&quot;/storageadapter&quot;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;
      &lt;span class=&quot;token property&quot;&gt;&quot;backend&quot;&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;
        &lt;span class=&quot;token property&quot;&gt;&quot;serviceName&quot;&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&quot;storage-adapter-svc&quot;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;
        &lt;span class=&quot;token property&quot;&gt;&quot;servicePort&quot;&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;9022&lt;/span&gt;
      &lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;
    &lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;
  &lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;
&lt;span class=&quot;token punctuation&quot;&gt;]&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;bash&quot;&gt;&lt;pre class=&quot;language-bash&quot;&gt;&lt;code class=&quot;language-bash&quot;&gt;&lt;span class=&quot;token comment&quot;&gt;# Executes the patch&lt;/span&gt;
kubectl patch ingress remotemonitoring --type json -p &lt;span class=&quot;token string&quot;&gt;&quot;&lt;span class=&quot;token variable&quot;&gt;&lt;span class=&quot;token variable&quot;&gt;$(&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;cat&lt;/span&gt; patch.json&lt;span class=&quot;token variable&quot;&gt;)&lt;/span&gt;&lt;/span&gt;&quot;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;&lt;strong&gt;Hope this helped!&lt;/strong&gt;&lt;/p&gt;</content:encoded><author>jp.reisgoncalves@gmail.com</author></item><item><title><![CDATA[Deploying a Gatsby blog in GitHub pages]]></title><description><![CDATA[For some time I was thinking of creating my own blog. The main goal was to record any cool stuff I would do during work or any issues I…]]></description><link>https://goncalvesj.github.io//deploy-gatsby-github-pages</link><guid isPermaLink="false">https://goncalvesj.github.io//deploy-gatsby-github-pages</guid><category><![CDATA[Gatsby]]></category><category><![CDATA[GitHub]]></category><pubDate>Sun, 12 Apr 2020 23:00:00 GMT</pubDate><content:encoded>&lt;p&gt;For some time I was thinking of creating my own blog. The main goal was to record any cool stuff I would do during work or any issues I would overcome. Finally the time has come!&lt;/p&gt;
&lt;p&gt;In this post I&apos;ll go through the steps I took to get a Gatsby starter blog up and running and deployed to GitHub pages.&lt;/p&gt;
&lt;h2 id=&quot;why-gatsby&quot; style=&quot;position:relative;&quot;&gt;&lt;a href=&quot;#why-gatsby&quot; aria-label=&quot;why gatsby permalink&quot; class=&quot;anchor before&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; focusable=&quot;false&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;Why Gatsby&lt;/h2&gt;
&lt;p&gt;Gatsby blogs are usually static sites and the content for the posts use markdown. Easy to set up and run and a personal interest in React.&lt;/p&gt;
&lt;h2 id=&quot;why-github-pages&quot; style=&quot;position:relative;&quot;&gt;&lt;a href=&quot;#why-github-pages&quot; aria-label=&quot;why github pages permalink&quot; class=&quot;anchor before&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; focusable=&quot;false&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;Why GitHub pages&lt;/h2&gt;
&lt;p&gt;It&apos;s easy to deploy and it&apos;s free.&lt;/p&gt;
&lt;h2 id=&quot;lets-start&quot; style=&quot;position:relative;&quot;&gt;&lt;a href=&quot;#lets-start&quot; aria-label=&quot;lets start permalink&quot; class=&quot;anchor before&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; focusable=&quot;false&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;Let&apos;s start&lt;/h2&gt;
&lt;h3 id=&quot;1---install-the-gatsby-cli&quot; style=&quot;position:relative;&quot;&gt;&lt;a href=&quot;#1---install-the-gatsby-cli&quot; aria-label=&quot;1   install the gatsby cli permalink&quot; class=&quot;anchor before&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; focusable=&quot;false&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;1 - Install the Gatsby CLI&lt;/h3&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;bash&quot;&gt;&lt;pre class=&quot;language-bash&quot;&gt;&lt;code class=&quot;language-bash&quot;&gt;&lt;span class=&quot;token function&quot;&gt;npm&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;install&lt;/span&gt; -g gatsby-cli&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;h3 id=&quot;2---choose-a-starter-blog&quot; style=&quot;position:relative;&quot;&gt;&lt;a href=&quot;#2---choose-a-starter-blog&quot; aria-label=&quot;2   choose a starter blog permalink&quot; class=&quot;anchor before&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; focusable=&quot;false&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;2 - Choose a starter blog&lt;/h3&gt;
&lt;p&gt;Go to the Gatsby website and pick a starter.&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;&lt;a href=&quot;https://www.gatsbyjs.org/starters/?v=2&quot;&gt;https://www.gatsbyjs.org/starters/?v=2&lt;/a&gt;&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;In my case I used this one:&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;&lt;a href=&quot;https://www.gatsbyjs.org/starters/ammarjabakji/gatsby-markdown-blog-starter/&quot;&gt;https://www.gatsbyjs.org/starters/ammarjabakji/gatsby-markdown-blog-starter/&lt;/a&gt;&lt;/strong&gt;&lt;/p&gt;
&lt;h3 id=&quot;3---create-a-github-repository&quot; style=&quot;position:relative;&quot;&gt;&lt;a href=&quot;#3---create-a-github-repository&quot; aria-label=&quot;3   create a github repository permalink&quot; class=&quot;anchor before&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; focusable=&quot;false&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;3 - Create a GitHub repository&lt;/h3&gt;
&lt;p&gt;Create a repository named &lt;code class=&quot;language-text&quot;&gt;yourusername.github.io&lt;/code&gt;.&lt;/p&gt;
&lt;h3 id=&quot;4---create-your-starter-blog-into-the-repository&quot; style=&quot;position:relative;&quot;&gt;&lt;a href=&quot;#4---create-your-starter-blog-into-the-repository&quot; aria-label=&quot;4   create your starter blog into the repository permalink&quot; class=&quot;anchor before&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; focusable=&quot;false&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;4 - Create your starter blog into the repository&lt;/h3&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;bash&quot;&gt;&lt;pre class=&quot;language-bash&quot;&gt;&lt;code class=&quot;language-bash&quot;&gt;gatsby new gatsby-markdown-blog-starter https://github.com/ammarjabakji/gatsby-markdown-blog-starter&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;&lt;strong&gt;A couple of notes here:&lt;/strong&gt;&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;I created a separate branch to host the blog code where I do all dev and then run the deploy command.&lt;/li&gt;
&lt;li&gt;The deploy command pushes the files to the master branch.&lt;/li&gt;
&lt;li&gt;The master branch is the one that hosts the static files generated by the Gatsby build (Default GitHub pages configuration).&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;&lt;strong&gt;Folder structure for a quick start:&lt;/strong&gt;&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;content folder - where the blog posts are&lt;/li&gt;
&lt;li&gt;data/SiteConfig.js - site name, links, etc.&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;Deploy the website:&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;bash&quot;&gt;&lt;pre class=&quot;language-bash&quot;&gt;&lt;code class=&quot;language-bash&quot;&gt;&lt;span class=&quot;token function&quot;&gt;npm&lt;/span&gt; run build:gh&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;This command will clean the output folders, run a Gatsby production build and use the &lt;code class=&quot;language-text&quot;&gt;gh-pages&lt;/code&gt; npm package to deploy to GitHub.&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;And that&apos;s it, navigate to your GitHub URL you should see the blog up and running!&lt;/strong&gt;&lt;/p&gt;</content:encoded><author>jp.reisgoncalves@gmail.com</author></item></channel></rss>